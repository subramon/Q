extern int 
Collapse(
	 double *buf1,   
	 double *buf2,  
	 int *ptr_weight, 
	 int bufidx1,
	 int bufidx2,  
	 int b,        
	 int k  
	 );
